<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>ì¼ì½œì´AI - ì±„íŒ…</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="https://cdn-uicons.flaticon.com/uicons-regular-rounded/css/uicons-regular-rounded.css">
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="app">
      <header class="app-header">
        <a class="logo" href="index.html">ì¼ì½œì´AI</a>
        <div class="header-right">
          <span class="model-pill">Gemini 2.5 Pro</span>
          <button id="theme-toggle" class="theme-toggle" type="button" aria-label="í…Œë§ˆ í† ê¸€">
            ğŸŒ
          </button>
        </div>
      </header>

      <main class="app-main">
        <!-- ì™¼ìª½: ì±„íŒ…/ìºë¦­í„° ë¦¬ìŠ¤íŠ¸ -->
        <aside class="sidebar">
          <div class="sidebar-top">
            <button class="btn primary full" id="new-chat-btn">
              + ìƒˆ ì±„íŒ…
            </button>
          </div>
          <div class="sidebar-section">
            <div class="sidebar-title">ìºë¦­í„°</div>
            <div class="character-list">
              <button class="character-card active">
                <div class="char-avatar">AI</div>
                <div class="char-meta">
                  <div class="char-name">ê¸°ë³¸ ë´‡</div>
                  <div class="char-sub">ì¼ë°˜ ì–´ì‹œìŠ¤í„´íŠ¸</div>
                </div>
              </button>
              <button class="character-card">
                <div class="char-avatar pink">ğŸ©·</div>
                <div class="char-meta">
                  <div class="char-name">ë´‡1</div>
                  <div class="char-sub">ì¥ë¬¸ íŠ¹í™”</div>
                </div>
              </button>
              <button class="character-card">
                <div class="char-avatar blue">ğŸ“š</div>
                <div class="char-meta">
                  <div class="char-name">ë´‡2</div>
                  <div class="char-sub">ìƒì‚°ì„±</div>
                </div>
              </button>
            </div>
          </div>

          <a class="btn subtle full" href="index.html">â† ë©”ì¸ìœ¼ë¡œ</a>
        </aside>

        <!-- ê°€ìš´ë°: ì±„íŒ… ì˜ì—­ -->
        <main class="chat-section">
          <div class="chat-header">
            <div class="chat-title-area">
              <div class="chat-title">ê¸°ë³¸ ë´‡</div>
              <div class="chat-subtitle" id="session-subtitle">
                ìƒˆ ì„¸ì…˜ Â· ì¥ê¸°ê¸°ì–µ ìš”ì•½ ì ìš© ì•ˆ ë¨
              </div>
            </div>
            <div class="chat-header-actions">
              <button
                class="icon-btn"
                id="clear-chat-btn"
                title="ì±„íŒ… ì´ˆê¸°í™”"
              >
                ğŸ—‘
              </button>
            </div>
          </div>

          <div id="chat-log" class="chat-log">
            <!-- ë©”ì‹œì§€ë“¤ì´ JSë¡œ ë“¤ì–´ì˜´ -->
          </div>

          <form id="chat-form" class="chat-input">
            <textarea
              id="chat-input"
              rows="2"
              placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ê³  Ctrl+Enter / âŒ˜+Enterë¡œ ì „ì†¡í•´ë³´ì„¸ìš”!"
            ></textarea>
            <div class="chat-input-footer">
              <div class="chat-hints">
                <span>Enter: ì¤„ë°”ê¿ˆ Â· Ctrl/Cmd+Enter: ì „ì†¡</span>
              </div>
              <div class="chat-buttons">
                <button type="submit" class="btn primary">ë³´ë‚´ê¸°</button>
              </div>
            </div>
          </form>
        </main>

        <!-- ì˜¤ë¥¸ìª½: ì¥ê¸°ê¸°ì–µ / ì„¸ì…˜ ì •ë³´ íŒ¨ë„ -->
        <aside class="sidepanel">
          <div class="panel-section">
            <div class="panel-title">ğŸ§  ì¥ê¸°ê¸°ì–µ (ìš”ì•½)</div>
            <div id="memory-box" class="memory-box">
              ì•„ì§ ì €ì¥ëœ ì¥ê¸°ê¸°ì–µì´ ì—†ì–´ìš”.<br />
              ë‚˜ì¤‘ì— ìš”ì•½ ì‹œìŠ¤í…œ ë¶™ì´ê¸°
            </div>
            <button class="btn subtle full" id="fake-memory-btn">
              (í…ŒìŠ¤íŠ¸ìš©) ê°€ì§œ ê¸°ì–µ ë„£ì–´ë³´ê¸°
            </button>
          </div>

          <div class="panel-section">
            <div class="panel-title">ğŸ“Š ì„¸ì…˜ ìƒíƒœ</div>
            <ul class="session-info" id="session-info">
              <li>ëŒ€í™” í„´: <span id="turn-count">0</span></li>
              <li>ë¦¬ë¡¤ íšŸìˆ˜: <span id="reroll-count">0</span></li>
              <li>ë§ˆì§€ë§‰ ë©”ì‹œì§€ ê¸¸ì´: <span id="last-length">0 ì</span></li>
            </ul>
          </div>
        </aside>
      </main>
    </div>

        <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <!-- Firebase ì´ˆê¸°í™” & Firestore ì„¤ì • -->
    <script type="module">
      // Firebase core
      import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
      // Firestore
      import { 
        getFirestore, 
        collection, 
        addDoc, 
        getDocs,
        doc,
        updateDoc,
        deleteDoc
      } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

      // Firebase ì„¤ì • (ì›…ë‹ˆ ì½˜ì†”ì—ì„œ ê°€ì ¸ì˜¨ ê°’)
      const firebaseConfig = {
        apiKey: "AIzaSyAdlXOdvcrY2EgpJ5jUYvp5j1HXeYDJ6i4",
        authDomain: "ilkoliai-c3b91.firebaseapp.com",
        projectId: "ilkoliai-c3b91",
        storageBucket: "ilkoliai-c3b91.firebasestorage.app",
        messagingSenderId: "195364000798",
        appId: "1:195364000798:web:b6585eb88e9065c54b0a0f",
        measurementId: "G-DB8VYMPZH7"
      };

      // Firebase / Firestore ì´ˆê¸°í™”
      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);

      // ë‹¤ë¥¸ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì“°ê¸° í¸í•˜ê²Œ windowì— ë¶™ì´ê¸°
      window.firebaseDB = db;
      window.firebaseCollection = collection;
      window.firebaseAddDoc = addDoc;
      window.firebaseGetDocs = getDocs;
      window.firebaseDoc = doc;
      window.firebaseUpdateDoc = updateDoc;
      window.firebaseDeleteDoc = deleteDoc;
    </script>

    <!-- íŒŒì´ì–´ë² ì´ìŠ¤ ì´ˆê¸°í™”ê°€ ëë‚œ ë’¤ main.js ì‹¤í–‰ -->
    <script src="main.js"></script>
    <div id="toast" class="toast"></div>
  </body>
</html>
